<title>LOSSST</title><meta content="width=device-width,user-scalable=no"name=viewport><script>v=0;function x(){scene.style.transform="translateX(-"+snakex[head]*sidesize+"vh)translateY(-"+snakey[head]*sidesize+"vh)translateZ(45vh)rotateX(40deg)rotateZ("+v+"rad)"}var z=position=index=0,C=2*Math.PI;function E(){var g=0;this.h=function(f){g+=f/48E3*C;return g%=C}}function F(g){var f=new E,n=new E,k=.1;this.h=function(){if(!g)return 0;var q=g+.4*Math.sin(n.h(3));q=440*Math.pow(2,(q-57)/12);k*=.9998;q=f.h(q);return Math.pow(Math.sin(q),1)*k}}function G(g){function f(){var f=g.length/2;for(index=position;0>index;)index+=f;index%=f;f=new F(g[2*index+0].charCodeAt(0)-48);for(var q=new F(g[2*index+1].charCodeAt(0)-48),t=[],y=0;48E3>y;y++){var A=f.h(),D=q.h(),K=.5*A+D;t.push(A+.5*D);t.push(K)}n(t).play()}function n(f){function g(f){f=k(f);return f[0]+f[1]}function k(f){for(var g=0,k="",n=0;4>n;n++,g+=8)k+=String.fromCharCode(f>>g&255);return k}var n=2*f.length;n="RIFF"+k(n+36)+"WAVEfmt "+k(16)+g(1)+g(2)+k(48E3)+k(192E3)+g(4)+g(16)+"data"+k(n);for(var A in f)n+=g(32767*f[A]);return new Audio("data:audio/wav;base64,"+btoa(n))}position=-1;this.forward=function(){position++;f()};this.back=function(){position--;f()}}function H(g){function f(f){f=n(f);return f[0]+f[1]}function n(f){for(var g=0,k="",n=0;4>n;n++,g+=8)k+=String.fromCharCode(f>>g&255);return k}for(var k=[],q=0;;q++){var t=g(q);if(null===t)break;k.push(t)}g=2*k.length;g="RIFF"+n(g+36)+"WAVEfmt "+n(16)+f(1)+f(1)+n(48E3)+n(96E3)+f(2)+f(16)+"data"+n(g);for(q in k)g+=f(1E4*k[q]);return new Audio("data:audio/wav;base64,"+btoa(g))}var I=Math.pow,J=Math.sin;function M(g){return 1E4<g?null:(I(g,1.055)&128?1:-1)*I((1E4-g)/1E4,2)}function N(g){return 25E3<g?null:((g^g>>3^g*g*7.3^g<<4)&65535)/65536*((25E3-g)/25E3)}function O(g){return 5E3<g?null:(I(g+1E3*J(.01*g),.8)&200?.5:-.5)*I((5E3-g)/5E3,1)}function Q(g){var f=16E3/7;if(16E3<g)return null;var n=I((16E3-g)/16E3,2.1);return(g<f?g+10*J(-g/900)&16:g&13)?n:-n}function R(g){return 9E4<g?null:(I(g+1E3*J(.01*g),.8)&200?.5:-.5)*I((9E4-g)/9E4,1)}var S=new G("nbo0risiubv0uisirbs0uiniojrlsjuivjymvjubv0uisgu0vnxnzgx0vnunsgrisjulvmulsjufscrbs0ui");song2=new G("p0r0sdk0rco0pdk0p0r0sdw0rcs0pdk0p0r0sdk0rck0pdk0p0r0sdw0rcs0pd0f0g0iwg0bwgx0wgurrnspur0bufwgubs0pkrcsdk0rco0pkk0p0r0sdk0rco0pk0l0k0iwg0b0k0g0n0kzs0nxi0f|l0izr0p0n0lwk0dwg0k0p0k|s0pur0kuo0k0i0l0k0isd0krj0kpd0k0p0rsd0krl0opd0f0g0iskw0riw0pgw0nfw0u`s0rbs0pd0k");L=localStorage;P="lossst_";easteregg=0;currentsong=(son=+L[P+"son"]||0)?song2:S;mobile=+L[P+"mobile"]||0;ocd_time=+L[P+"time"]||0;ocd_moves=+L[P+"moves"]||0;int_time=0;touchintervals=[];fx=0;sidesize=5;head=0;snakex=[];snakey=[];snakez=[];snakeangle=[];snakelength=L[P+"snakelength"]=+L[P+"snakelength"]||5;lock=u=r=d=l=s=c=B=puzzling=iseditor=0;trees=[];apples=[];doors=[];cubes=[];hints=[];puzzles=[];currentpuzzle=null;cellprefix="0";dg=[];dw=[];size=topoffset=leftoffset=issolved=haswrap=haswall=hasground=0;totalsolved=+L[P+"totalsolved"]||0;stuck=inbounds=exithead=0;pagename="";w=h=0;enterroom=function(){var g;navigator.userAgent.match(/Mac/)&&(perspective.className="mac");navigator.userAgent.match(/Fire|Edg/)&&(perspective.className+=" fx",fx=4E3);mobile&&(perspective.className+=" mobile");b.className=pagename;son&&!iseditor&&(snake.innerHTML="");cubes=[];doors=[];trees=[];apples=[];hints=[];emoji=[];if("pz"==pagename)w=40,h=20,puzzles=[[5,,1,,"0000000000000000000000000",16,9]],snakelength=5,son=0;else if("py"==pagename)h=w=20,puzzles=[eval("["+location.hash.slice(1).replace(/[01]{2,}/g,'"$&"')+"]")],snakelength=puzzles[0][1],puzzles[0][5]=puzzles[0][6]=8,son=!!puzzles[0][3],hints=[["Move: arrow keys<br>"+(son?"Up/Down: "+(mobile?"\u2b06\ufe0e/\u2b07\ufe0e":"Shift/Ctrl")+"<br>":"")+"backtrack: "+(mobile?"\u21a9":"Alt")+"<br>Reset: R",1,5,1,0,son,0]],delete L[P+"puzzlepy0"];else if("px"==pagename){w=40;h=20;trees=[[13,9,0],[7,13,0],[35,8,0]];apples=[[11,11,0,0,0],[2,12,0,6,0],[38,10,0,7,0]];doors=[[41,10,Math.PI/2,8,0,"pA",1,0,10,0,0],[20,-2,0,14,0,"pD",1,10,19,0,0],[-2,11,-Math.PI/2,6,0,"pJ",1,14,5,1,1],[20,21,Math.PI,14,0,"pC",1,22,1,0,0],[5,21,Math.PI,5,0,"pI",1,36,1,0,1]];puzzles=[];cubes=[];for(f=9;15>f;f++)for(k=0;5>k;k++)2==k&&14==f||2==k&&13==f||3==k&&13==f||3==k&&12==f||2==k&&12==f||cubes.push([k,f]);hints=[["Move with<br>arrow keys"+(mobile?"":" or WASD/ZQSD"),19,5,0,13,0],["Use the "+(mobile?"\u21a9":"Alt")+" key to backtrack",1,9,0,13,0,1],["Approach red doors with the right length to open them",35,14,0,13,0],["Puzzle editor<br>\u2193",19,8,14,0,0],["\u2191<br>New puzzles !",16,6,14,0,0],["New ! Puzzle editor with wraps<br>\u2193",19,8,6,7,1],["\u2190<br>New puzzles !",1,9,6,7,1,1]];emoji=[["\ud83d\udc3f\ufe0f",30,7],["\ud83c\udf30\ufe0f",29,7]]}else if("pA"==pagename)w=40,h=20,trees=[[35,15,0]],apples=[[33,16,0,0,6],[34,17,0,0,6],[37,15,0,0,6]],cubes=[],doors=[[-2,10,-Math.PI/2,8,0,"px",0,39,11,0,0],[35,21,Math.PI,11,0,"pB",1,35,1,0,0]],puzzles=[[6,,0,,"000000001000001110001110001000000000",2,3],[6,,0,,"000000011000011100010000011000000000",14,3],[6,,0,,"000000000100001100011000011100000000",26,3],[5,,0,,"0000001110011100110000000",2,13],[6,,0,,"000000011000011000001100001100000000",14,13],[6,,0,,"000000000100001100001110001100000000",26,13]],hints=[["Cover the black shapes to solve puzzles",9,9,1,0],["Solve all the puzzles in the room to get new apples and unlock a new door",21,9,1,0],["Your progress is saved automatically",34,9,1,0]],emoji=[["\ud83d\udc0c",11,10]];else if("pB"==pagename)mobile&&(kx.className="",L[P+"reset"]=1),w=40,h=20,trees=[[4,7,0]],apples=[[1,8,0,0,12],[2,9,0,0,12]],doors=[[35,-2,0,8,0,"pA",0,35,19,0,0],[-2,10,-Math.PI/2,13,0,"pC",1,39,10,0,0]],puzzles=[[6,,0,,"000000011110011010011110000000000000",8,2],[7,,0,,"0000000001110000111000001100000110000010000000000",18,2],[6,,0,,"000000011000011110001010001110000000",28,2],[6,,0,,"000000011100001110001110001100000000",8,12],[6,,0,,"000000001110001110001110001010000000",18,12],[6,,0,,"000000011110011110001100001000000000",28,12]],hints=[["If you get stuck, "+(mobile?"click \u00d7":"press R")+" to exit a puzzle",35,11,1,0],["If a puzzle looks impossible, try another entry !",14,10,1,0]],cubes=[[11,4],[21,16]],emoji=[["\ud83d\udc08",4,14]];else if("pC"==pagename)w=40,h=20,trees=[[35,8,0]],apples=[[34,11,0,0,18]],doors=[[41,10,Math.PI/2,8,0,"pB",0,1,10,0,0],[22,-2,0,14,0,"px",1,20,19,0,0]],puzzles=[[7,,0,,"0000000000000001111000111100001111000100000000000",2,3],[7,,0,,"0000000001110000101000011100001110000110000000000",26,3],[6,,0,,"000000001110011110011010001110000000",14,3],[7,,0,,"0000000001100000111000011100001110000110000000000",2,12],[7,,0,,"0000000000000001111100101010011111000000000000000",14,12],[6,,0,,"000000011000011100011110011110000000",26,12]],hints=[["\u2191<br>After this room, you can try a puzzle editor and a new kind of puzzles !",22,11,13,0,0]],cubes=[[29,5],[30,8],[17,6],[15,4],[15,7],[29,13],[30,13],[30,14],[18,15],[16,15],[6,13],[6,17],[7,8],[6,8],[5,8],[3,7],[3,8],[7,6],[7,5]],emoji=[["\ud83e\udd8b<br><br>",29,13]];else if("pD"==pagename){h=w=20;trees=[[10,2,0]];doors=[[10,21,Math.PI,14,0,"px",0,20,0,0,0],[-2,5,-Math.PI/2,14,0,"pE",0,24,12,0,0]];puzzles=[[7,,1,,"0100010011111000000000000000000000001111100100010",7,7]];hints=[["Now you're thinking with wraps !",2,2,0,14,0]];for(f=0;20>f;f++)cubes.push([f,10]);emoji=[["\ud83d\udc10",12,2]]}else if("pE"==pagename)h=w=25,trees=[[5,12,0]],apples=[[4,14,0,0,23]],doors=[[26,12,Math.PI/2,14,0,"pD",0,0,5,0,0],[-2,12,-Math.PI/2,15,0,"pF",1,79,5,0,0]],puzzles=[[7,,1,,"1000001000000000000000010100011011011000111000001",3,3],[6,,1,,"110011100001000000100001100001110011",15,17],[5,,1,,"1100111001100011001110011",16,4],[6,,1,,"000011000011110001110001000011000011",3,17]],hints=[["Reminder:<br>use "+(mobile?"\u21a9":"Alt")+" to backtrack,<br>"+(mobile?"\u00d7":"R")+" to exit a puzzle.",11,14,1,0,0]],emoji=[["\ud83d\udc12",12,20]];else if("pF"==pagename)w=80,h=20,trees=[[35,10,0]],apples=[[38,11,0,0,35]],doors=[[81,5,Math.PI/2,15,0,"pE",0,0,12,0,0],[-2,15,-Math.PI/2,16,0,"pG",1,19,5,0,0]],puzzles=[[5,,1,,"0111101001010110100011111",59,13],[5,,1,,"1111011000111100001011110",48,13],[5,,1,,"1111101000011110111001100",37,13],[5,,1,,"1111110000111001000011111",26,13],[5,,1,,"1100101101001110011101101",15,13],[5,,1,,"1111100001110010000111111",59,2],[5,,1,,"1000110111100011000111111",48,2],[5,,1,,"1000110101101011111110001",37,2],[5,,1,,"1111110001000110000111111",26,2],[5,,1,,"0111101100011100011011110",15,2],[5,,1,,"1111101111001110001100001",4,8],[5,,1,,"1010100101111010000111111",71,8]],hints=[["This room hides a surprise !",72,2,0,15,0],["\u2190<br>Exit",38,9,16,0,0]],cubes=[],emoji=[];else if("pG"==pagename)w=20,h=30,trees=[[5,25,0]],apples=[[4,24,0,0,37],[7,25,0,0,37],[2,26,0,0,37],[3,28,0,0,37]],doors=[[21,5,Math.PI/2,16,0,"pF",0,1,15,0,0],[10,31,Math.PI,20,0,"pH",1,10,1,0,0]],puzzles=[[6,,1,,"001000001110111111011100011000001000",7,6],[6,,1,,"110001100001000111000111100001110001",7,18]],emoji=[["\ud83d\udc01",9,14]];else if("pH"==pagename)w=20,h=30,trees=[[16,22]],apples=[[18,22,0,0,39]],doors=[[10,-2,0,18,0,"pG",0,10,29,0,0],[21,25,Math.PI/2,21,0,"pI",1,1,10,0,0]],puzzles=[[6,,1,,"001000011110111111011110011110001000",7,6],[6,,1,,"110001100001000011000111001111111111",7,18]],emoji=[["\ud83e\udd86",9,14]];else if("pI"==pagename){w=40;h=20;apples=[[38,2,0,5,0]];doors=[[-2,10,-Math.PI/2,1,0,"pH",0,19,25,0,0],[36,-2,0,6,0,"px",1,5,19,0,1]];puzzles=[];hints=[["Guess what, you finished the first half of the game !",5,9,1,0],["Little snake can move up and down with "+(mobile?"\u2b06\ufe0e and \u2b07\ufe0e":"Shift and Ctrl keys")+", and open black doors",26,9,1,0]];for(f=0;9>f;f++)cubes.push([30,f]);for(f=30;40>f;f++)cubes.push([f,8]);emoji=[["\ud83d\udc22",13,14]]}else"pJ"==pagename?(w=15,h=70,trees=[[2,62]],apples=[[2,65,0,0,47],[1,66,0,0,47]],doors=[[16,5,Math.PI/2,6,0,"px",0,1,11,0,1],[-2,65,-Math.PI/2,8,0,"pK",1,19,65,0,1]],puzzles=[[5,,0,"0000000000000000000001110",,2,2],[4,,0,"0000000001000110",,4,11],[5,,0,"0000000000000000101001110",,6,20],[5,,0,"0000000000000000111000100",,8,29],[4,,0,"0000000001100110","0000011001100000",2,38],[4,,0,"0000010001100100","0000011001100000",4,47],[4,,0,"0000011001000100","0000010001100000",6,56],[4,,0,"0000000001100110","0100011000100000",8,65]],hints=[["You now have to match the patterns on the walls...",10,2,1,0,1],["... and on the floor too !",10,40,1,0,1],["Beware the gravity: you can't fly !",2,68,1,0,1]],emoji=[["\ud83e\udd89",10,14]]):"pK"==pagename?(mobile&&(ky.className=kz.className="",L[P+"camera"]=1),w=20,h=75,trees=[[2,2]],apples=[[1,4,0,0,59],[2,5,0,0,59],[3,6,0,0,59],[4,2,0,0,59]],doors=[[21,65,Math.PI/2,7,0,"pJ",0,1,65,0,1],[-2,5,-Math.PI/2,12,0,"pL",1,14,5,0,1]],puzzles=[[5,,0,"0000000000010000110001110",,8,69],[6,,0,"000000000000000000000100001110011000",,12,58],[5,,0,"0000000000010000111001000",,2,58],[4,,0,"0000001001100110","0000001001100000",2,45],[5,,0,"0000000000000000010001110","0000000100001100110000000",12,45],[5,,0,"0000000000000000101001110","0000001110010100000000000",2,34],[5,,0,"0000000000000000011001100","0000001110011000010000000",12,34],[4,,1,"0000011001100110","0110000000000110",2,22],[4,,1,"1001000000001001","1001000000001001",12,22],[4,,1,"0000010011110010","0000111101100000",2,12],[4,,1,"0110010000000011","0000011100110000",12,12],[4,,1,"1101000000000001","1101000000010001",12,2]],hints=[["You can rotate the camera with "+(mobile?"<br>\u21bb and \u21ba":"the keys 1, 2 and 3"),15,68,1,0,1],["Can you guess what's coming next?",7,54,1,0,1],["Yep... 3D puzzles with wrap ! Use "+(mobile?"\u2b06\ufe0e and \u2b07\ufe0e":"Shift and Ctrl")+" to wrap between top and bottom",7,24,1,0,1]],emoji=[["\ud83d\udc1e",3,70]]):"pL"==pagename?(w=15,h=80,trees=[[2,70]],apples=[[1,73,0,0,68],[3,75,0,0,68]],doors=[[16,5,Math.PI/2,12,0,"pK",0,1,5,0,1],[-2,75,-Math.PI/2,14,0,"pM",1,14,25,0,1]],puzzles=[[5,,0,"0000000000001001111100100",,2,2],[4,,0,"0000010001100000",,5,11],[5,,0,"0000000110000110111000010",,8,20],[5,,0,"0000000000001000111011111","0000000000111001111100000",2,29],[4,,0,"1000110011101111","0000001111110000",5,38],[4,,0,"0000100011001110","1110110010000000",8,45],[4,,1,"1000100110010001","0000100110010000",2,54],[4,,1,"0000001011110100","0000110011110011",5,63],[5,,1,"0100011000010000111001000","0000001110110000100000000",8,72]],cubes=[[6,12]],emoji=[["\ud83d\udc1d",3,20]]):"pM"==pagename?(w=15,h=30,trees=[[10,12]],apples=[[8,11,0,0,71],[9,10,0,0,71],[10,9,0,0,71],[11,10,0,0,71],[12,11,0,0,71],[7,12,0,0,71]],doors=[[16,25,Math.PI/2,14,0,"pL",0,1,75,0,1],[-2,5,-Math.PI/2,20,0,"pN",1,14,5,0,1]],puzzles=[[5,,1,"0001100110011001100010000","0001100110011001100010000",2,24],[5,,1,"1100010001000011000111000","0000011000110010000000000",4,13],[5,,1,"1101110001000001000011000","1100010000000001000111011",6,2]],emoji=[["\ud83d\udc13",1,14]]):"pN"==pagename&&(w=15,h=48,trees=[[10,44]],apples=[[7,45,0,0,75]],doors=[[16,5,Math.PI/2,20,0,"pM",0,1,5,0,1]],puzzles=[[4,,1,"0000111101101111","1000111111111000",5,38],[4,,1,"1111001001001111","1111101010101111",5,28],[4,,1,"1111010101011101","0001101101101111",5,18],[4,,1,"1111000100011110","1111110110011111",5,8]],emoji=[["\ud83d\udc09",13,46]]);scene.style.width=w*sidesize+"vh";scene.style.height=h*sidesize+"vh";iseditor||(objects.innerHTML="");puzzle.innerHTML="";for(var f in trees)objects.innerHTML+="<div id=tree"+f+' class="emoji tree"style=left:'+trees[f][0]*sidesize+"vh;transform:translateX(-7vh)translateY("+(trees[f][1]*sidesize+4)+"vh)rotateX(-70deg)>\ud83c\udf33</div><div id=treeshadow"+f+' class="emojishadow treeshadow"style=left:'+trees[f][0]*sidesize+"vh;transform:translateX(-7.5vh)translateY("+(trees[f][1]*sidesize+3.5)+"vh)rotateZ(144deg)scaleY(1.5)>\ud83c\udf33";for(f in apples)L[P+"appleeaten"+pagename+f]?delete apples[f]:objects.innerHTML+="<div id=apple"+f+' class="emoji apple '+(L[P+"appleappeared"+pagename+f]?"":"hidden")+'"style=left:'+apples[f][0]*sidesize+"vh;transform:translateY("+(apples[f][1]*sidesize+4)+"vh)rotateX(-65deg)>"+("pN"==pagename?"<div>\u26bd</div>":"<div class=emojimove>\ud83c\udf4e</div>")+"</div><div id=appleshadow"+f+' class="emojishadow appleshadow '+(L[P+"appleappeared"+pagename+f]?"":"hidden")+'"style=left:'+apples[f][0]*sidesize+"vh;transform:scaleX(-1)translateY("+(apples[f][1]*sidesize+3)+"vh)rotateZ(212deg)>"+("pN"==pagename?"\u26bd":"\ud83c\udf4e");for(f in emoji)objects.innerHTML+='<div class="emoji animal"style=left:'+(emoji[f][1]*sidesize-1)+"vh;transform:translateY("+(emoji[f][2]*sidesize+4)+"vh)rotateX(-65deg)><div class=emojimove>"+emoji[f][0];for(f in doors)objects.innerHTML+="<div id=door"+(""+pagename+f)+' class="door'+(L[P+"door"+pagename+f]?" open":"")+'"style=left:'+(doors[f][0]+.5)*sidesize+"vh;top:"+(doors[f][1]+.5)*sidesize+"vh;transform:rotateZ("+doors[f][2]+"rad)translateZ("+doors[f][9]*sidesize+'vh)><div class="realdoor door'+doors[f][10]+'"'+(doors[f][6]?"":"hidden")+">"+doors[f][3]+"</div><div class=path>";for(var n in puzzles)for(var k in cubes)L[P+"puzzle"+pagename+n]&&cubes[k][0]>=puzzles[n][5]&&cubes[k][0]<puzzles[n][5]+puzzles[n][0]&&cubes[k][1]>=puzzles[n][6]&&cubes[k][1]<puzzles[n][6]+puzzles[n][0]&&delete cubes[k];for(f in cubes)objects.innerHTML+="<div id=cube"+f+' class="cube rock"style=left:'+cubes[f][0]*sidesize+"vh;top:"+cubes[f][1]*sidesize+'vh;width:5vh;height:5vh><div class=front></div><div class=up style="background-position:'+(-300-cubes[f][0]*sidesize)+"vh "+(-140-cubes[f][1]*sidesize)+'vh"></div><div class=right></div><div class=left></div><div class=back>';for(f in hints)son^hints[f][5]||!(hints[f][3]&&hints[f][3]<=snakelength||hints[f][4]&&hints[f][4]>=snakelength)||(objects.innerHTML+="<div id=hint"+(""+pagename+f)+" class=hint style=left:"+hints[f][1]*sidesize+"vh;transform:translateY("+(hints[f][2]*sidesize+5)+"vh)translateZ("+(hints[f][6]*sidesize||0)+"vh)rotateX(-70deg)translateY(-4vh)>"+hints[f][0]);for(n in puzzles){size=puzzles[n][0];var q=g="";puzzle.innerHTML+="<div id=puzzle"+n+' class="cube wrap visible '+(puzzles[n][2]&&!L[P+"puzzle"+pagename+n]?"wrapvisible":"")+'"style=left:'+puzzles[n][5]*sidesize+"vh;top:"+puzzles[n][6]*sidesize+"vh;width:"+puzzles[n][0]*sidesize+"vh;height:"+size*sidesize+"vh>"+(puzzles[n][2]?"<div class=left></div><div class=right></div>":"")+"<div id=down"+n+" class=down></div><div id=back"+n+" class=back></div>"+(puzzles[n][2]?"<div class=front>":"");var t="000",y="fff";L[P+"puzzle"+pagename+n]&&(t="44c",y="fd0",puzzles[n][2]=0);for(f=0;f<size;f++)for(k=0;k<size;k++)puzzles[n][3]&&(g+="<div class=cell id=w"+n+"-"+f+"-"+k+" style=width:"+sidesize+"vh;height:"+sidesize+"vh;background:#"+("1"==puzzles[n][3][f*size+k]?t:y)+"></div>"),puzzles[n][4]&&(q+="<div class=cell id=g"+n+"-"+f+"-"+k+" style=width:"+sidesize+"vh;height:"+sidesize+"vh;background:#"+("1"==puzzles[n][4][f*size+k]?t:y)+"></div>");top["down"+n]&&(top["down"+n].innerHTML+=q);top["back"+n]&&(top["back"+n].innerHTML+=g)}"pN"==pagename&&(objects.innerHTML+="<div style='position:fixed;transform:rotateZ(-90deg)translateX(-73vh)translateY(21vh)translateZ(338vh);font:30vh/30vh a'>THE<br><br>END");iseditor&&(L[P+"editorfull"]||L[P+"son"]&&6<L[P+"snakelength"]||(ground.style.opacity=groundlabel.style.opacity=0,ground.style.position=groundlabel.style.position="fixed",ground.style.top=groundlabel.style.top="-9vh"),currentpuzzle=0,movesnake(1),hasground=1,issolved=haswrap=haswall=0,puzzles[0][2]=0,setTimeout(function(){(gridsize.onchange=gridsize.oninput=resetgrid=function(){resetsnake();movesnake();share.disabled=1;gridval.innerHTML=size=+gridsize.value;puzzle0.style.width=puzzle0.style.height=size*sidesize+"vh";puzzles[0][0]=size;down0.innerHTML="";q=g=back0.innerHTML="";dw=[];dg=[];for(f=0;f<size;f++)for(dw[f]=[],dg[f]=[],k=0;k<size;k++)dw[f][k]=0,dg[f][k]=0;for(f=0;f<size;f++)for(k=0;k<size;k++)g+="<div class=cell id=w"+cellprefix+"-"+f+"-"+k+" style=width:"+sidesize+"vh;padding-top:"+sidesize+"vh></div>",q+="<div class=cell id=g"+cellprefix+"-"+f+"-"+k+" style=width:"+sidesize+"vh;padding-top:"+sidesize+"vh></div>";hasground&&(down0.innerHTML+=q);haswall&&(back0.innerHTML+=g)})();snakesize.onchange=snakesize.oninput=function(){snakeval.innerHTML=snakelength=+snakesize.value;resetsnake();movesnake()};ground.onclick=function(){ground.checked?hasground=1:top.m&&(hasground=0,son=haswall=1,wall.checked=!0);scene.className=haswall?"haswall":"";resetgrid()};top.m&&(wall.onclick=function(){top.m&&wall.checked?(haswall=1,son=puzzles[0][3]=1):(haswall=son=0,hasground=1,ground.checked=!0,puzzles[0][3]=0);scene.className=haswall?"haswall":"";resetgrid()});top.o&&(wrap.onclick=function(){haswrap=puzzles[0][2]=wrap.checked||0;puzzle0.className="cube wrap visible "+(haswrap?"wrapvisible":"");resetgrid()});print=function(g){var n="";for(f=0;f<size;f++)for(k=0;k<size;k++)n=top[g+"0-"+f+"-"+k].style.background&&top[g+"0-"+f+"-"+k].style.background.match(/255/)?n+0:n+1;return n};share.onclick=function(){var f=[];f.push(size);f.push(snakelength);f.push(haswrap?1:0);f.push(haswall?print("w"):"");f.push(ground.checked?print("g"):"");window.open("//twitter.com/intent/tweet?text=I%20made%20a%20level%20for%20@MaximeEuziere's%20%23js13k%20game%20LOSSST!%0APlay%20here:%20http%3A%2F%2Fjs13kgames.com%2Fentries%2Flossst%0AMy%20level:%20http%3A%2F%2Fjs13kgames.com%2Fgames%2Flossst%2Findex.html%23"+f+"%0A%23LOSSSTlevels")}},100));"px"!=pagename||L[P+"snakex"]?(scene.style.transition="transform 1s,transform-origin 1s",resetsnake()):(lock=1,setTimeout(function(){resetsnake();movesnake();snakecubemove0.style.transition="transform .5s"},2E3),setTimeout(function(){snakex.push(snakex[head]);snakey.push(snakey[head]);snakez.push(0);snakeangle.push(snakeangle[head]);head++;movesnake()},5500+fx),setTimeout(function(){snakecubemove0.style.transition="";snakecuberotate0.style.transition="transform .2s";snakecuberotate0.style.transform="rotateZ("+-Math.PI/4+"rad)"},6500+fx),setTimeout(function(){snakecuberotate0.style.transform="rotateZ("+Math.PI/4+"rad)"},7E3+fx),setTimeout(function(){snakecuberotate0.style.transform=""},7500+fx),setTimeout(function(){snakeshadow0.style.transition=snakecuberotate0.style.transition=""},8E3+fx),setTimeout(function(){clearInterval(z);lock=0},8400),setTimeout(function(){scene.style.transition="transform 1s,transform-origin 1s";L[P+"snakex"]=20;L[P+"snakey"]=10;b.innerHTML+="<div style='position:fixed;font:8vh a;top:3vh;right:3vh'onclick=location='index.html'>\u00d7";mobile&&(kU.className=kD.className=kL.className=kR.className="",L[P+"wasd"]=1)},9E3));movesnake()};resetsnake=function(g){var f=son&&!iseditor?snake2:snake;f.innerHTML="";g||(snakex=[],snakey=[],snakez=[],snakeangle=[]);head=snakelength-1;if(!g)if("py"==pagename)for(i=0;i<snakelength;i++)snakex[head-i]=1-i,snakey[head-i]=10,snakez[head-i]=0,snakeangle[head-i]=-Math.PI/2;else if(iseditor)for(i=0;i<snakelength;i++)snakex[head-i]=13-i,snakey[head-i]=12,snakez[head-i]=0,snakeangle[head-i]=-Math.PI/2;else if(L[P+"snakex"]){g=+L[P+"snakex"];var n=+L[P+"snakey"],k=+L[P+"snakez"];"px"==pagename&&2>snakex[head]&&(k=L[P+"snakez"]=1);if("pI"==pagename&&easteregg&&1==son)for(i=0;i<snakelength;i++)snakex[head-i]=20,snakey[head-i]=10,snakez[head-i]=-i-1,snakeangle[head-i]=0;else if(2>g)for(i=0;i<snakelength;i++)snakex[head-i]=g-i,snakey[head-i]=n,snakez[head-i]=k,snakeangle[head-i]=-Math.PI/2;else if(g>w-2)for(i=0;i<snakelength;i++)snakex[head-i]=g+i,snakey[head-i]=n,snakez[head-i]=k,snakeangle[head-i]=Math.PI/2;else if(2>n)for(i=0;i<snakelength;i++)snakex[head-i]=g,snakey[head-i]=n-i,snakez[head-i]=k,snakeangle[head-i]=0;else if(n>h-2)for(i=0;i<snakelength;i++)snakex[head-i]=g,snakey[head-i]=n+i,snakez[head-i]=k,snakeangle[head-i]=0;else for(i=0;i<snakelength;i++)snakex[head-i]=20,snakey[head-i]=10,snakez[head-i]=-i,snakeangle[head-i]=0}else if("px"==pagename)for(i=0;i<snakelength;i++)snakex[head-i]=20,snakey[head-i]=10,snakez[head-i]=-i-1,snakeangle[head-i]=0;for(i=0;i<Math.max(snakelength+4,16);i++)f.innerHTML+="<div id=snakecubemove"+i+" class=snakecubemove style=transform:translateX(50vh)translateY(50vh)translateZ(-30vh);width:"+(sidesize-.7)+"vh;height:"+(sidesize-.7)+"vh><div class=snakeshadow id=snakeshadow"+i+"></div><div id=snakecuberotate"+i+' class=snakecuberotate><div class="cube snake"id=snakecube'+i+">"+(1>i?"<div class=tongue>Y</div>":"")+'<div class=up style="font:'+.5*sidesize+"vh/"+.8*sidesize+'vh a">'+(1>i?"\ud83d\udc40":"")+"</div><div class=front>"+(1>i?"\u203f":"")+"</div><div class=right></div><div class=left></div><div class=back>"};indexx=function(g,f){if(0===g||"pz"==g)clearInterval(z),index=position=0;"pz"==g&&(iseditor=1,delete L[P+"puzzlepez"],currentpuzzle=0);pagename=g||L[P+"page"]||"px";document.body.outerHTML="<body id=b class="+pagename+">\n<div id=perspective>\n<div id=scene style=transform:translateX(-97vh)translateY(-50vh)rotateZ(90deg)translateZ(119vh);transform-origin:100vh+50vh>\n<div id=objects>"+(iseditor?"<div class=hint style=width:60vh;transform:translateX(70vh)translateY(1vh)translateZ(2vh)rotateX(-42deg)>\n<label style=width:100%;text-align:center>Create a pattern with the snake and share it !</label>\n<br style=line-height:6vh>\n<div style=text-align:left;padding-left:5vh>\n<label>Grid</label> <input id=gridsize type=range value=5 min=3 max=8 step=1>\n<span id=gridval>5</span>\n<br>\n<label>Snake</label> <input id=snakesize type=range value=5 min=5 max=40 step=1>\n<span id=snakeval>5</span>\n</div>\n<input type=checkbox id=ground checked> <label for=ground id=groundlabel>ground</label>\n"+(L[P+"editorfull"]||L[P+"son"]&&6<L[P+"snakelength"]?"<input type=checkbox id=wall> <label for=wall>wall</label>":"")+"\n"+(L[P+"editorfull"]||L[P+"son"]?"<input type=checkbox id=wrap> <label for=wrap>wrap</label>":"")+"\n<br>\n<center>\n<button id=share disabled>Share</button>\n</center>\n</div>":"")+"\n</div>\n<div id=puzzle></div>\n<div id=snake></div>\n<div id=snake2></div>\n</div>\n</div>\n<center id=mobilecontrols style='font:5vh arial,sans-serif;color:#fff;position:fixed;bottom:9vh;left:0;width:100vw'>\n<button id=kU class=hidden ontouchstart=touchstart(38) ontouchend=touchend(38)>\u2191</button>\n<button id=kD class=hidden ontouchstart=touchstart(40) ontouchend=touchend(40)>\u2193</button>\n<button id=kL class=hidden ontouchstart=touchstart(37) ontouchend=touchend(37)>\u2190</button>\n<button id=kR class=hidden ontouchstart=touchstart(39) ontouchend=touchend(39)>\u2192</button>\n<button id=kT class=hidden ontouchstart=touchstart(16) ontouchend=touchend(16)>\u2b06\ufe0e</button>\n<button id=kB class=hidden ontouchstart=touchstart(17) ontouchend=touchend(17)>\u2b07\ufe0e</button>\n<button id=kw class=hidden ontouchstart=touchstart(18) ontouchend=touchend(18)>\u21a9</button>\n<button id=kx class=hidden ontouchstart=touchstart(82) ontouchend=touchend(82)>\u00d7</button>\n<button id=ky class=hidden ontouchstart=touchstart(49) ontouchend=touchend(49)>\u21bb</button>\n<button id=kz class=hidden ontouchstart=touchstart(51) ontouchend=touchend(51)>\u21ba</button>\n</center>\n<center id=text style='font:5vh arial,sans-serif;color:#fff;position:fixed;bottom:9vh;left:0;width:100vw'>";L[P+"appleappearedpx0"]=1;enterroom();if(mobile&&"py"==pagename||L[P+"wasd"])kU.className=kD.className=kL.className=kR.className="";if(mobile&&"py"==pagename||L[P+"backtrack"])kw.className="";if(mobile&&"py"==pagename||L[P+"reset"])kr.className="";if(mobile&&"py"==pagename||L[P+"topbottom"])kT.className="",kB.className="";if(mobile&&"py"==pagename||L[P+"camera"])ky.className="",kz.className="";iseditor||(int_time=setInterval(function(){L[P+"time"]=++ocd_time;document.title="LOSSST: "+ocd_moves+"m, "+ocd_time+"s"},1E3));f&&(b.innerHTML+="<div style='position:fixed;font:8vh a;top:3vh;right:3vh'onclick=location='index.html'>\u00d7")};touchstart=function(g){touchintervals[g]&&clearInterval(touchintervals[g]);onkeydown({which:"+n+"});touchintervals[g]=setInterval(function(){onkeydown({which:g})},150)};touchend=function(g){setTimeout(function(){clearInterval(touchintervals[g]);top.onkeyup()},150)};onload=function(){1<location.hash.length?indexx("py",1):(setTimeout(function(){z=setInterval(function(){currentsong.forward()},500)},200),b.innerHTML="<center id=e>\ud83d\udc40</center>\n<center id=itext></center>\n<div id=perspective style=perspective:30vh>\n<center id=menu>\n<h1>LOSSST</h1>\n<span onclick=a()>New game</span><br>\n"+(L[P+"start"]&&!L[P+"ended"]?"<span onclick=indexx(0,1)>Continue</span><br>":"")+"\n<span onclick=indexx(\"pz\",1)>Puzzle editor</span><br>\n<span onclick=window.open('//xem.github.io/JS13k17/bonus')>Bonus",a=function(){for(i in localStorage)0==i.indexOf("lossst")&&-1==i.indexOf("editorfull")&&delete localStorage[i];L[P+"start"]=1;menu.innerHTML="<br><br><span onclick=intro(0)>Desssktop</span><br><br><span onclick=intro(1)>Mobile"},intro=function(g){clearInterval(z);index=position=0;z=setInterval(currentsong.forward,250);L[P+"mobile"]=mobile=g;L[P+"snakelength"]=snakelength=5;ocd_time=L[P+"time"]=0;ocd_moves=L[P+"moves"]=0;L[P+"moves"]=0;L[P+"time"]=0;menu.innerHTML="";setTimeout(function(){e.style.margin=0},500);dir=1;inter=setInterval(function(){e.style.opacity=0;setTimeout(function(){e.style.opacity=1;dir=-dir;e.style.transform="scaleX("+dir+")"},150)},3E3);setTimeout(function(){itext.innerHTML="I lossst my kid !"},2E3);setTimeout(function(){itext.innerHTML=""},5E3);setTimeout(function(){clearInterval(inter);e.style.margin="-80vh 0 0"},7E3);setTimeout(indexx,7500)})};movesnake=function(g){for(var f={a:0};f.a<snakelength;f={a:f.a,i:f.i,j:f.j,l:f.l},f.a++)if(!g){var n=oldx=oldy=oldz=newx=newy=newz=0;haswrap&&size&&(snakex[head-f.a-1]==leftoffset&&snakex[head-f.a]==leftoffset+size-1?(n=1,oldx=leftoffset-1,newx=leftoffset+size,oldy=newy=snakey[head-f.a],oldz=newz=snakez[head-f.a]):snakex[head-f.a-1]==leftoffset+size-1&&snakex[head-f.a]==leftoffset?(n=1,oldx=leftoffset+size,newx=leftoffset-1,oldy=newy=snakey[head-f.a],oldz=newz=snakez[head-f.a]):snakey[head-f.a-1]==topoffset&&snakey[head-f.a]==topoffset+size-1?(n=1,oldy=topoffset-1,newy=topoffset+size,oldx=newx=snakex[head-f.a],oldz=newz=snakez[head-f.a]):snakey[head-f.a-1]==topoffset+size-1&&snakey[head-f.a]==topoffset?(n=1,oldy=topoffset+size,newy=topoffset-1,oldx=newx=snakex[head-f.a],oldz=newz=snakez[head-f.a]):0==snakez[head-f.a-1]&&snakez[head-f.a]==size-1?(n=1,oldz=-1,newz=size,oldx=newx=snakex[head-f.a],oldy=newy=snakey[head-f.a]):snakez[head-f.a-1]==size-1&&0==snakez[head-f.a]&&(n=1,oldz=size,newz=-1,oldx=newx=snakex[head-f.a],oldy=newy=snakey[head-f.a]));if(n)top["snakecuberotate"+f.a].style.transform="rotateZ("+snakeangle[head-f.a]+"rad)",top["snakecubemove"+f.a].style.transform="translateX("+(oldx*sidesize+.5)+"vh)translateY("+(oldy*sidesize+.5)+"vh)translateZ("+(oldz*sidesize+.5)+"vh)scale(.01)scaleZ(.01)",setTimeout(function(f){return function(){top["snakecubemove"+f.a].style.transition="none"}}(f),90),f.i=newx,f.j=newy,f.l=newz,setTimeout(function(f){return function(){top["snakecubemove"+f.a].style.transform="translateX("+(f.i*sidesize+.5)+"vh)translateY("+(f.j*sidesize+.5)+"vh)translateZ("+(f.l*sidesize+.5)+"vh)scale(.01)"}}(f),100),setTimeout(function(f){return function(){top["snakecubemove"+f.a].style.transition="";top["snakecubemove"+f.a].style.transform="translateX("+(snakex[head-f.a]*sidesize+.25)+"vh)translateY("+snakey[head-f.a]*sidesize+"vh)translateZ("+(snakez[head-f.a]*sidesize+.5)+"vh)"}}(f),150);else try{top["snakecubemove"+f.a].style.transform="translateX("+(snakex[head-f.a]*sidesize+.25)+"vh)translateY("+snakey[head-f.a]*sidesize+"vh)translateZ("+(snakez[head-f.a]*sidesize+.5)+"vh)",top["snakecuberotate"+f.a].style.transform="rotateZ("+snakeangle[head-f.a]+"rad)"}catch(q){}try{top["snakeshadow"+f.a].style.display=0==snakez[head-f.a]?"":"none"}catch(q){}}iseditor?scene.style.transform="translateX(-100vh)translateY(-37vh)translateZ(-5vh)rotateX(33deg)":null===currentpuzzle||L[P+"puzzle"+pagename+currentpuzzle]?(scene.style.transform="translateX("+-snakex[head]*sidesize+"vh)translateY("+-snakey[head]*sidesize+"vh)translateZ(45vh)rotateX(40deg)rotateZ("+v+"rad)",scene.style.transformOrigin=""+snakex[head]*sidesize+"vh "+snakey[head]*sidesize+"vh"):(scene.style.transform="translateX("+(-(leftoffset+puzzles[currentpuzzle][0]/2)*sidesize+5)+"vh)translateY("+(-(topoffset+puzzles[currentpuzzle][0]/2)*sidesize+8)+"vh)translateZ("+(90-puzzles[currentpuzzle][0]*(sidesize+3))+"vh)rotateX(30deg)rotateZ("+v+"rad)",scene.style.transformOrigin=""+((leftoffset+puzzles[currentpuzzle][0]/2)*sidesize+5)+"vh "+((topoffset+puzzles[currentpuzzle][0]/2-1)*sidesize+8)+"vh");f=son?1:0;for(g=0;g<snakelength;g++){if(0>=snakez[head-g]){f=0;break}for(k in cubes)cubes[k][0]==snakex[head-g]&&cubes[k][1]==snakey[head-g]&&1==snakez[head-g]&&(f=0)}if(f){for(g=0;g<snakelength;g++)snakez[head-g]--;try{movesnake()}catch(q){for(var k=2*snakelength;k--;)snakex.pop(),snakey.pop(),snakez.pop(),snakeangle.pop(),head--;exithead=0;movesnake()}}f=snakex[head];n=snakey[head];for(g in doors)(doors[g][10]&&son||!doors[g][10]&&!son)&&top["door"+pagename+g]&&0<doors[g][3]&&snakelength>=doors[g][3]&&4>Math.hypot(f-doors[g][0],n-doors[g][1])&&!L[P+"door"+pagename+g]&&(top["door"+pagename+g].className="door open",!doors[g][6]||"px"==pagename&&2<g||H(R).play(),L[P+"door"+pagename+g]=1),top["door"+pagename+g]&&"door open"==top["door"+pagename+g].className&&2>Math.hypot(f-doors[g][0],n-doors[g][1])&&(L[P+"page"]=pagename=doors[g][5],setTimeout(enterroom,600),L[P+"snakex"]=doors[g][7],L[P+"snakey"]=doors[g][8],L[P+"snakez"]=0,L[P+"snakeangle"]=snakeangle[head]);null!==currentpuzzle&&checkgrid();puzzling=0;iseditor||(currentpuzzle=null);iseditor||(dg=[],dw=[]);for(p in puzzles)if(f>=puzzles[p][5]&&f<puzzles[p][5]+puzzles[p][0]&&n>=puzzles[p][6]&&n<puzzles[p][6]+puzzles[p][0]){currentpuzzle=+p;issolved=0;L[P+"puzzle"+pagename+p]?issolved=1:puzzling=1;cellprefix=p;hasground=!!puzzles[p][4];haswall=!!puzzles[p][3];haswrap=!!puzzles[p][2];leftoffset=puzzles[p][5];topoffset=puzzles[p][6];size=puzzles[p][0];for(g=0;g<size;g++)for(dg[g]=[],dw[g]=[],k=0;k<size;k++)puzzles[p][3]&&(dw[g][k]=+puzzles[p][3][g*puzzles[p][0]+k]),puzzles[p][4]&&(dg[g][k]=+puzzles[p][4][g*puzzles[p][0]+k]);checkgrid()}};checkmove=function(g,f,n){stuck=0;if(0>g||g>=w||0>f||f>=h)stuck=1;for(var k in trees)g>=trees[k][0]-1&&g<=trees[k][0]&&f==trees[k][1]&&(stuck=1);for(k in hints)g>=hints[k][1]&&g<=hints[k][1]+3&&f==hints[k][2]&&snakelength>=hints[k][3]&&(!hints[k][4]||snakelength<=hints[k][4])&&(son&&hints[k][5]||!son&&!hints[k][5])&&(stuck=1);for(k in apples)if(L[P+"appleappeared"+pagename+k]&&g==apples[k][0]&&f==apples[k][1]&&0==snakez[head])if(H(M).play(),"pN"==pagename){lock=1;z=setInterval(currentsong.forward,150);L[P+"ended"]=1;setTimeout(function(){appleshadow0.remove();apple0.style.transform="translateY(319vh)translateZ(2vh)rotateX(-65deg)rotateY(90deg)";apple0.style.transition=scene.style.transition="10s";apple0.style.transform="translateY(15vh)translateZ(2vh)rotateX(-65deg)";scene.style.transform=mobile?"translateX(-133vh)translateY(-249vh)translateZ(-373vh)rotateZ(90deg)":"translateX(-144vh)translateY(-249vh)translateZ(-340vh)rotateZ(90deg)"},200);var q={},t;for(t in puzzles)q.f=t,setTimeout(function(f){return function(){top["back"+f.f].style.transition=".5s";top["back"+f.f].style.transform="translateY(-125%)"}}(q),[1450,2500,3900,5500][q.f]),q={f:q.f};setTimeout(function(){clearInterval(int_time);L[P+"editorfull"]=1;b.style.background="#000";L[P+"son"]=0;b.innerHTML="<div id=perspective style=perspective:90vh><center id=menu style=width:75vh;transform:translateX(-38vh)translateY(-35vh)rotateX(-28deg)><span style=font-size:4vh;line-height:5vh><h1>Congrats!</h1><br>You completed the game in<br>"+ocd_time+" seconds and "+ocd_moves+" moves!<br><br><a href=https://twitter.com/intent/tweet?text=I%20played%20LOSSST,%20a%20%23js13k%20game%20by%20by%20@MaximeEuziere%0Amy%20score:%20"+ocd_time+"%20seconds%20and%20"+ocd_moves+"%20moves!%0Ahttp%3A%2F%2Fjs13kgames.com%2Fentries%2Flossst target=_blank style=color:#def;font-size:4vh>TWEET YOUR SCORE</a><br><br>Dev record:<br>1265 seconds, 3071 moves<br><br>3D puzzle editor unlocked !<br><br><a href=index.html style=font-size:4vh>TITLE SCREEN"},15E3);n=document.querySelectorAll(".cell");q={};for(var y in n){q.g=y;try{2==n[q.g].style.backgroundColor.match(/68/g).length&&setTimeout(function(f){return function(){top[n[f.g].id].style.background="#a00"}}(q),8E3+10*q.g)}catch(D){}q={g:q.g}}}else if(delete apples[k],top["apple"+k].remove(),top["appleshadow"+k].remove(),snakelength++,L[P+"snakelength"]=snakelength,L[P+"appleeaten"+pagename+k]=1,"pF"==pagename&&16==snakelength){lock=1;z=setInterval(currentsong.forward,150);easteregg=1;scene.style.transition="5s";scene.style.transform="translateX(-180vh)translateY(-53vh)translateZ("+(mobile?-422:-180)+"vh)rotateZ(180deg)";setTimeout(function(){scene.style.transition="1s";lock=easteregg=0;movesnake();objects.innerHTML+="<div class=hint style=left:190vh;transform:translateY(50vh)rotateX(-55deg)translateY(-4vh)>\u2190<br>Exit";clearInterval(z)},1E4);n=document.querySelectorAll(".cell");q={};for(var A in n){q.c=A;try{n[q.c].id.match(/g\d-/)&&2==n[q.c].style.backgroundColor.match(/68/g).length&&setTimeout(function(f){return function(){top[n[f.c].id].style.background="#a00"}}(q),5500+10*q.c)}catch(D){}q={c:q.c}}}for(k in cubes)g==cubes[k][0]&&f==cubes[k][1]&&0==n&&(stuck=1);for(k in emoji)"pC"!=pagename&&g==emoji[k][1]&&f==emoji[k][2]&&0==n&&(stuck=1);for(k in doors)top["door"+pagename+k]&&"door open"==top["door"+pagename+k].className&&2>=Math.hypot(g-doors[k][0],f-doors[k][1])&&(stuck=0);for(k=snakelength-2;0<k;k--)snakex[head-k]==g&&snakey[head-k]==f&&snakez[head-k]==n&&(stuck=1);for(p in puzzles)puzzles[p][3]&&g>=puzzles[p][5]&&g<puzzles[p][5]+puzzles[p][0]&&(f==puzzles[p][6]-1&&snakey[head]==puzzles[p][6]&&!puzzles[p][2]||f==puzzles[p][6]&&snakey[head]==puzzles[p][6]-1)&&(stuck=1);if("pI"==pagename&&18==g&&!son){easteregg=son=lock=stuck=1;clearInterval(z);currentsong=song2;index=position=0;z=setInterval(song2.forward,250);L[P+"son"]=1;L[P+"snakelength"]=snakelength=5;for(g=0;21>g;g++)cubes.push([snakex[head-g],snakey[head-g]]),top["snakecubemove"+g].id="",top["snakecuberotate"+g].id="",top["snakeshadow"+g].id="",top["snakecube"+g].id="";scene.style.transition="2s";resetsnake();movesnake();scene.style.transform="translateX(-105vh)translateY(-51vh)translateZ(80vh)rotateX(45deg)";scene.style.transformOrigin="140vh 70vh";setTimeout(function(){snakex.push(snakex[head]);snakey.push(snakey[head]);snakez.push(0);snakeangle.push(snakeangle[head]);head++;movesnake()},3E3);setTimeout(function(){text.innerHTML="Daddy!"},4E3);setTimeout(function(){text.innerHTML=""},6E3);setTimeout(function(){text.innerHTML="I lossst my soccer ball!"},7E3);setTimeout(function(){text.innerHTML=""},9E3);setTimeout(function(){text.innerHTML="But I found new moves!"},1E4);setTimeout(function(){text.innerHTML="";easteregg=lock=0;clearInterval(z);scene.style.transition="1s";movesnake();checkapple();mobile&&(kT.className=kB.className="",L[P+"topbottom"]=1)},13E3)}};checkgrid=function(){if(!issolved&&null!==currentpuzzle){solved=1;iseditor&&(share.disabled=0);for(i=0;i<size;i++)for(j=0;j<size;j++)try{top["g"+cellprefix+"-"+i+"-"+j]&&(top["g"+cellprefix+"-"+i+"-"+j].style.background=dg[i][j]?"#000":"#fff"),top["w"+cellprefix+"-"+i+"-"+j]&&(top["w"+cellprefix+"-"+i+"-"+j].style.background=dw[i][j]?"#000":"#fff")}catch(k){}if(snakex[head]<leftoffset||snakex[head]>leftoffset+size-1||snakey[head]<topoffset||snakey[head]>topoffset+size-1||0>snakez[head]||snakez[head]>size-1)iseditor&&(share.disabled=1);else{for(i=0;i<snakelength;i++){top["g"+cellprefix+"-"+(snakey[head-i]-topoffset)+"-"+(snakex[head-i]-leftoffset)]&&(top["g"+cellprefix+"-"+(snakey[head-i]-topoffset)+"-"+(snakex[head-i]-leftoffset)].style.background=dg[snakey[head-i]-topoffset][snakex[head-i]-leftoffset]?"#080":iseditor?"#44c":"#f00");snakey[head-i]>=topoffset&&snakey[head-i]<topoffset+size&&top["w"+cellprefix+"-"+(size-1-snakez[head-i])+"-"+(snakex[head-i]-leftoffset)]&&(top["w"+cellprefix+"-"+(size-1-snakez[head-i])+"-"+(snakex[head-i]-leftoffset)].style.background=dw[size-1-snakez[head-i]][snakex[head-i]-leftoffset]?"#080":iseditor?"#44c":"#f00");if(snakex[head-i]<leftoffset||snakex[head-i]>leftoffset+size-1||snakey[head-i]<topoffset||snakey[head-i]>topoffset+size-1||snakez[head-i]>size-1)iseditor&&(share.disabled=1),solved=0;hasground&&dg[snakey[head-i]-topoffset]&&!dg[snakey[head-i]-topoffset][snakex[head-i]-leftoffset]&&(solved=0);haswall&&dw[size-1-snakez[head-i]]&&!dw[size-1-snakez[head-i]][snakex[head-i]-leftoffset]&&(solved=0)}for(i=0;i<size;i++)for(j=0;j<size;j++){try{hasground&&3==top["g"+cellprefix+"-"+i+"-"+j].style.backgroundColor.match(/0/g).length&&(solved=0)}catch(k){}try{haswall&&3==top["w"+cellprefix+"-"+i+"-"+j].style.backgroundColor.match(/0/g).length&&(solved=0)}catch(k){}}if(solved){issolved=iseditor?0:1;puzzles[currentpuzzle][2]=0;top["puzzle"+currentpuzzle].classList.remove("wrapvisible");iseditor||(L[P+"puzzle"+pagename+currentpuzzle]=1);for(i=0;i<size;i++)for(j=0;j<size;j++){try{top["g"+cellprefix+"-"+i+"-"+j].style.background=dg[i][j]?"#44c":"#fd0"}catch(k){}try{top["w"+cellprefix+"-"+i+"-"+j].style.background=dw[i][j]?"#44c":"#fd0"}catch(k){}}iseditor||(H(Q).play(),totalsolved++,L[P+"totalsolved"]=totalsolved);var g=1,f={},n;for(n in cubes)f.b=n,cubes[f.b][0]>=puzzles[currentpuzzle][5]&&cubes[f.b][0]<puzzles[currentpuzzle][5]+puzzles[currentpuzzle][0]&&cubes[f.b][1]>=puzzles[currentpuzzle][6]&&cubes[f.b][1]<puzzles[currentpuzzle][6]+puzzles[currentpuzzle][0]&&(delete cubes[f.b],g++,setTimeout(function(f){return function(){top["cube"+f.b].remove()}}(f),200*g)),f={b:f.b}}}}};checkapple=function(){for(var g in apples)if(!L[P+"appleappeared"+pagename+g]&&(0<apples[g][3]&&apples[g][3]==snakelength||0<apples[g][4]&&apples[g][4]==totalsolved)){lock=1;mobile&&"px"==pagename&&1==g&&(kw.className="",L[P+"backtrack"]=1);var f=setTimeout;scene.style.transform="translateX("+-apples[g][0]*sidesize+"vh)translateY("+-apples[g][1]*sidesize+"vh)translateZ(50vh)rotateX(35deg)";L[P+"appleappeared"+pagename+g]=1;scene.style.transformOrigin=""+apples[g][0]*sidesize+"vh "+apples[g][1]*sidesize+"vh";f(void 0,250);f=setTimeout;top["apple"+g].className="emoji apple";top["appleshadow"+g].className="emojishadow appleshadow";f(void 0,800);setTimeout(function(){H(N).play()},950);setTimeout(function(){movesnake();lock=0},2E3)}};testinbounds=function(){inbounds=0;iseditor||(currentpuzzle=null);for(p in puzzles)snakex[head]>=puzzles[p][5]&&snakex[head]<puzzles[p][5]+puzzles[p][0]&&snakey[head]>=puzzles[p][6]&&snakey[head]<puzzles[p][6]+puzzles[p][0]&&0<=snakez[head]&&snakez[head]<puzzles[p][0]&&(currentpuzzle=+p,inbounds=1)};onkeydown=function(g){top["lurd************************l**r************l*d***u**u"[g.which-37]]=1;18==g.which&&(B=1);16==g.which&&(s=1);17==g.which&&(c=1);if(!lock){if(49==g.which||97==g.which)-1<v&&v--,x();if(50==g.which||98==g.which)v=0,x();if(51==g.which||99==g.which)1>v&&v++,x()}testinbounds();inbounds?checkgrid():exithead=0;if(82==g.which&&inbounds){if(exithead<=head)for(var f=exithead;f<=head;f++)snakex.pop(),snakey.pop(),snakez.pop(),snakeangle.pop(),setTimeout(function(){currentsong.back()},70*(head-f));head=exithead-1;exithead=0;movesnake();checkgrid();L[P+"moves"]=++ocd_moves;document.title="LOSSST: "+ocd_moves+"m, "+ocd_time+"s"}else if(116!=g.which&&82!=g.which&&17!=g.which&&123!=g.which&&g.preventDefault&&g.preventDefault(),!lock){stuck=0;if(l)!issolved&&haswrap&&inbounds&&snakex[head]==leftoffset?(checkmove(leftoffset+size-1,snakey[head],snakez[head]),stuck||(snakex.push(leftoffset+size-1),snakey.push(snakey[head]),snakez.push(snakez[head]),snakeangle.push(Math.PI/2),head++)):(checkmove(snakex[head]-1,snakey[head],snakez[head]),stuck||(snakex.push(snakex[head]-1),snakey.push(snakey[head]),snakez.push(snakez[head]),snakeangle.push(Math.PI/2),head++));else if(r)!issolved&&haswrap&&inbounds&&snakex[head]==leftoffset+size-1?(checkmove(leftoffset,snakey[head],snakez[head]),stuck||(snakex.push(leftoffset),snakey.push(snakey[head]),snakez.push(snakez[head]),snakeangle.push(-Math.PI/2),head++)):(checkmove(snakex[head]+1,snakey[head],snakez[head]),stuck||(snakex.push(snakex[head]+1),snakey.push(snakey[head]),snakez.push(snakez[head]),snakeangle.push(-Math.PI/2),head++));else if(u)!issolved&&haswrap&&inbounds&&snakey[head]==topoffset?(checkmove(snakex[head],topoffset+size-1,snakez[head]),stuck||(snakex.push(snakex[head]),snakey.push(topoffset+size-1),snakez.push(snakez[head]),snakeangle.push(Math.PI),head++)):(checkmove(snakex[head],snakey[head]-1,snakez[head]),stuck||(snakex.push(snakex[head]),snakey.push(snakey[head]-1),snakez.push(snakez[head]),snakeangle.push(Math.PI),head++));else if(d)!issolved&&haswrap&&inbounds&&snakey[head]==topoffset+size-1?(checkmove(snakex[head],topoffset,snakez[head]),stuck||(snakex.push(snakex[head]),snakey.push(topoffset),snakez.push(snakez[head]),snakeangle.push(0),head++)):(checkmove(snakex[head],snakey[head]+1,snakez[head]),stuck||(snakex.push(snakex[head]),snakey.push(snakey[head]+1),snakez.push(snakez[head]),snakeangle.push(0),head++));else if((son||haswall)&&s){if(!inbounds){g=snakelength-1;for(f in cubes)cubes[f][0]==snakex[head]&&cubes[f][1]==snakey[head]&&g++;if(snakez[head]==g)return}!issolved&&haswrap&&inbounds&&snakez[head]==size-1?(checkmove(snakex[head],snakey[head],0),stuck||(snakex.push(snakex[head]),snakey.push(snakey[head]),snakez.push(0),snakeangle.push(snakeangle[head]),head++)):(checkmove(snakex[head],snakey[head],snakez[head]+1),stuck||(snakex.push(snakex[head]),snakey.push(snakey[head]),snakez.push(snakez[head]+1),snakeangle.push(snakeangle[head]),head++))}else(son||haswall)&&c?!issolved&&haswrap&&inbounds&&0==snakez[head]?(checkmove(snakex[head],snakey[head],size-1),stuck||(snakex.push(snakex[head]),snakey.push(snakey[head]),snakez.push(size-1),snakeangle.push(snakeangle[head]),head++)):0==snakez[head]?stuck=1:(checkmove(snakex[head],snakey[head],snakez[head]-1),stuck||(snakex.push(snakex[head]),snakey.push(snakey[head]),snakez.push(snakez[head]-1),snakeangle.push(snakeangle[head]),head++)):B&&head>snakelength&&(snakeangle.pop(),snakex.pop(),snakey.pop(),snakez.pop(),head--);stuck&&(lock=1,setTimeout(function(){lock=0},150),!(-1<snakex[head]&&snakex[head]<w&&-1<snakey[head]&&snakey[head]<h)||"pI"==pagename&&!son&&16<snakex[head]||H(O).play());if(!stuck&&!easteregg&&(u||r||d||l||s||c||B)){L[P+"moves"]=++ocd_moves;iseditor||(document.title="LOSSST: "+ocd_moves+"m, "+ocd_time+"s");checkgrid();movesnake();B?head>snakelength&&currentsong.back():(son||!s&&!c&&!son)&&currentsong.forward();movesnake(1);checkapple();lock||(lock=1,setTimeout(function(){lock=0},150));if("px"==pagename&&(son||14<=snakelength)&&20==snakex[head]&&10==snakey[head]){lock=1;var n=0;for(f=0;f<snakelength;f++)setTimeout(function(){snakex.push(snakex[head]);snakey.push(snakey[head]);snakez.push(--n);snakeangle.push(snakeangle[head]);head++;movesnake()},150*f);setTimeout(function(){indexx("pz",1)},160*snakelength);L[P+"snakex"]=20;L[P+"snakey"]=10}testinbounds();inbounds&&!exithead&&(exithead=head)}}};onkeyup=function(){u=r=d=l=s=c=B=0}</script><style>@keyframes move{0%,100%{transform:rotateY(-10deg)}50%{transform:rotateY(10deg)}}*{margin:0;padding:0;font:2.5vh/5.5vh arial,sans-serif;vertical-align:middle;box-sizing:border-box;-webkit-touch-callout:none;-webkit-user-select:none;-webkit-tap-highlight-color:transparent;user-select:none;cursor:pointer;touch-action:manipulation}html,body{height:100%;background:#000;overflow:hidden;background:radial-gradient(#def 25%,#7ce)}a{color:#def}input,button{position:relative;z-index:2}input[type=range]::-webkit-slider-runnable-track,input[type=range]::-webkit-slider-thumb{background:#888;border:1px solid #000}input[type=range]::-moz-range-track,input[type=range]::-moz-range-thumb{background:#888;border:1px solid #000}#perspective{width:0;height:0;perspective:120vh;position:absolute;top:50%;left:50%}#perspective *{transform-style:preserve-3d}#scene{width:0;height:0;transform-origin:18vh 0%;transition:transform 1s,transform-origin 1s}.cube{position:fixed;top:0;left:0}.cube>div{width:100%;height:100%;position:fixed}.cube .up{transform:rotateY(90deg)translateX(-100%)rotateY(-90deg)}.cube .left{transform:rotateX(-90deg)translateY(-50%)translateX(-50%)rotateY(-90deg)}.cube .right{transform:rotateX(-90deg)translateY(-50%)translateX(50%)rotateY(90deg)}.cube .front{transform:translateY(50%)rotateX(-90deg)translateY(-50%)}.cube .back{transform:translateY(-50%)rotateX(-90deg)translateY(-50%)rotateY(180deg)}.cube.wrap{width:32vh;height:32vh;transform:none}.cube.wrap>div{background:transparent}.cube.wrap .back{transition:opacity .5s;transform:translateY(-50%)rotateX(-90deg)translateY(-52%)}.cube.wrap.wrapvisible .down,.cube.wrap .down{transition:opacity .5s;background:#0c5b0c}.snakecubemove,.snakecuberotate{transform-origin:50% 50%;width:100%;height:100%;position:fixed}.snakecubemove{transition:transform .15s}.cube.snake{width:100%;height:100%}.cube.snake>div{box-shadow:0 0 0 .1vh #000 inset;text-align:center}.cube.snake .front{line-height:3vh}.cube.snake .tongue{background:none!important;box-shadow:none;color:red;font-size:4vh;text-align:center;transform:rotateZ(180deg)translateY(-4vh)translateZ(1.5vh)}#snake .cube.snake>div{background:#FFA500}#snake .cube.snake .up{background:#dF8500}#snake2 .cube.snake>div,#scene.haswall .cube.snake>div{background:#444}#snake2 .cube.snake .up,#scene.haswall .cube.snake .up{background:#333}#snake2 .cube.snake .front{color:#fff}.snakeshadow{position:fixed;width:100%;height:100%;background:rgba(0,0,0,.25);transform:translateX(14%)translateY(14%)translateZ(.2vh)}label{display:inline-block;width:22%}button{display:inline-block;width:23%;border:.2vh solid #000;margin:1vh 2% 0 0}input[type=range]{width:60%}#form{width:50vh;margin:auto}.cell{float:left;outline:.4vh solid #888;opacity:0;transition:opacity .5s;background:#fff}.cube.wrap.visible{transform:translateZ(.1vh)}.cube.wrap.visible .cell{opacity:1}.cube.wrap.visible .down{transform:none}.cube.wrap.wrapvisible>div{background:linear-gradient(45deg,rgba(200,200,200,.1),rgba(200,200,200,.3));box-shadow:0 0 .1vh rgba(255,255,255,.5)}.emoji{position:fixed;transform-origin:50% 100%;bottom:0}.emojimove{animation:move 3s infinite}.emojishadow{color:rgba(0,0,0,.002);text-shadow:0px 0px rgba(0,0,0,.25);position:fixed;transform-origin:50% 100%;bottom:0}.tree,.treeshadow{font:11vh/12vh a}.mac .tree{font:15vh/11vh a}.mac .treeshadow,.fx .treeshadow,.mobile .treeshadow,.mac .appleshadow,.fx .appleshadow,.mobile .appleshadow,.fx .rock.back,#mobilecontrols button.hidden{display:none}.apple,.apple *,.appleshadow{font:4vh/5vh a;transition:opacity .5s .5s}.animal,.animal *{font:5vh/6vh a}.apple.hidden,.appleshadow.hidden{opacity:0}.mac .apple{font:6vh/5vh a}.door{position:fixed;transform-origin:0% 100%;width:0;height:0}.door .path{position:fixed;width:15vh;height:15vh;background:linear-gradient(transparent,#640 50%);top:-7.4vh;left:-7.5vh}.door .realdoor{position:fixed;width:15vh;height:20vh;background:radial-gradient(2vh at 90% 50%,gold 35%,transparent 40%),#a22;border-radius:1vh 1vh 0 0;transform-origin:0% 100%;transform:translateX(-7.5vh)translateY(-12.5vh)rotateX(-90deg);text-align:center;font-size:6vh;line-height:12vh;color:#fff;transition:transform 1s}.door .realdoor.door1{background:radial-gradient(2vh at 90% 50%,gold 35%,transparent 40%),#222}.door.open .realdoor{transform:translateX(-7.5vh)translateY(-12.5vh)rotateX(-90deg)rotateY(90deg)}.cube.rock div{background:linear-gradient(45deg,#640,#583808)}.cube.rock div.up{transform:rotateY(90deg)translateX(-5.4vh)rotateY(-90deg);background:radial-gradient(#3F7D1F,#034301);background-size:280vh 140vh;width:5.3vh;height:5.3vh}.hint{position:fixed;background:#fff;padding:.7vh;width:20vh;font:2vh/2.5vh arial,sans-serif;transform-origin:50% 100%;text-align:center;box-shadow:0 0 0 .2vh #000 inset;bottom:0}.hint br{font:0/0 a}.hint:before{content:"";width:3vh;height:3vh;background:#750;position:absolute;bottom:-3vh;left:8vh;border-left:.2vh solid;border-right:.2vh solid}.pz .hint:before{left:28vh}label{text-align:left}#scene{transition:transform 6s ease-in,transform-origin 6s ease-in;width:280vh;height:140vh;background:radial-gradient(#4F8D2F,#136321);border-radius:3vh}.px #scene,.pI #scene{background:radial-gradient(10vh at 51.3% 52%,#000 40%,transparent 50%),radial-gradient(15vh at 51.3% 52%,#640 40%,transparent 50%),radial-gradient(#4F8D2F,#136321)}#e{margin:99vh 0 0;transition:margin 1s;font:10vh/80vh a}#itext{font:5vh arial,sans-serif;color:#fff;position:fixed;bottom:9vh;left:0;width:100vw}#menu{color:#fff;width:55vh;transform:translateX(-27vh)translateY(-20vh)rotateX(-17deg)}#menu span{font:7vh/12vh arial,sans-serif}#menu h1{font:13vh/16vh arial,sans-serif;text-shadow:.1vh -.1vh #777,.2vh -.2vh #777,.3vh -.3vh #777}#menu span:hover{color:#ace;transform:rotateX(-10deg)}.pN #menu span:hover{color:#fff}#mobilecontrols button{position:fixed;width:10vh;height:10vh;text-align:center;font:6vh/10vh a}#kU{right:14vh;bottom:14vh}#kD{right:14vh;bottom:2vh}#kL{right:26vh;bottom:2vh}#kR{right:2vh;bottom:2vh}#kT{left:2vh;top:2vh}#kB{left:2vh;top:14vh}#kw{bottom:2vh;left:2vh}#kx{bottom:14vh;left:2vh}#ky{top:2vh;right:18vh}#kz{top:2vh;right:6vh}</style><body id=b style=background:#000>