a=()=>{var k=0,m=()=>{scene.style.transform="translateX(-"+w[v]*q+"vh)translateY(-"+A[v]*q+"vh)translateZ(40vh)rotateX(40deg)rotateZ("+k+"rad)"},n=localStorage,o="lossst_",q=7,v=0,w=[],A=[],C=[],D=[],E=n[o+"snakelength"]=+n[o+"snakelength"]||5,F=0,G=1,H=0,I=r=d=l=s=c=B=0,J=0,K=[],M=[],N=[],O=[],Q=[],R=null,S="e",T=[],U=[],V=0,W=0,X=0,Y=0,Z=0,$=0,_=+n[o+"totalsolved"]||0,aa=0,ba="",ca=()=>{if(b.className=ba,"hub"==ba){for(K=[[13,9,0],[6,13,0],[35,8,0]],M=[[11,11,0,0,0],[2,12,0,6,0],[38,10,0,7,0]],N=[[41,10,Math.PI/2,8,0,"1-1",1,0,10,0],[20,-2,0,15,0,"2-1",1,0,0,0],[-2,11,-Math.PI/2,6,0,"3-1",1,0,0,1]],Q=[],O=[],ga=9;15>ga;ga++)for(j=0;5>j;j++)if(2==j&&14==ga||2==j&&13==ga||3==j&&13==ga||3==j&&12==ga||2==j&&12==ga);else O.push([j,ga]);}else"1-1"==ba?(K=[[35,8,0]],M=[[33,9,0,0,6]],O=[],N=[[-2,10,-Math.PI/2,8,0,"hub",0,39,11,0],[41,10,Math.PI/2,9,0,"1-2",1,1,9,0],[22,21,Math.PI,14,0,"1-4",0,22,1,0]],Q=[[6,8,0,,"000000001000001110001110001000000000",2,3],[6,8,0,,"000000011000011000001100001100000000",14,3],[6,8,0,,"000000000100001100011000011100000000",26,3],[5,8,0,,"0000001110011100110000000",2,13],[6,8,0,,"000000011000011100010000011000000000",14,13],[6,8,0,,"000000000100001100001110001100000000",26,13]]):"1-2"==ba?(K=[[35,8,0]],M=[[33,9,0,0,12],[34,10,0,0,12]],N=[[-2,9,-Math.PI/2,8,0,"1-1",0,39,10,0],[22,21,Math.PI,11,0,"1-3",1,22,1,0]],Q=[[6,9,0,,"000000000000001100001110011110000000",2,2],[7,9,0,,"0000000001100000110000010000001100000110000000000",14,2],[6,9,0,,"000000000000011000001110011110000000",26,2],[6,9,0,,"000000001110001110000110000010000000",2,11],[7,9,0,,"0000000000100000011000011100001100000010000000000",14,11],[6,9,0,,"000000011000011000001110000110000000",26,11]],O=[]):"1-3"==ba?(K=[[35,8,0]],M=[[33,9,0,0,18],[34,10,0,0,18]],N=[[22,-2,0,8,0,"1-2",0,22,19,0],[-2,10,-Math.PI/2,13,0,"1-4",1,39,10,0]],Q=[[6,11,0,,"000000011110011010011110000000000000",2,2],[7,11,0,,"0000000001110000111000001100000110000010000000000",14,2],[6,11,0,,"000000011000011110001010001110000000",26,2],[6,11,0,,"000000011100001110001110001100000000",2,11],[6,11,0,,"000000001110001110001110001010000000",14,11],[6,11,0,,"000000011110011110001100001000000000",26,11]],O=[]):"1-4"==ba&&(K=[[35,8,0]],M=[[34,11,0,0,24]],N=[[41,10,Math.PI/2,8,0,"1-3",0,1,10,0],[22,-2,0,14,0,"1-1",1,22,19,0]],Q=[[7,13,0,,"0000000000000001111000111100001111000100000000000",2,2],[7,13,0,,"0000000001110000101000011100001110000110000000000",14,2],[6,13,0,,"000000001110011110011010001110000000",26,2],[7,13,0,,"0000000001100000111000011100001110000110000000000",2,11],[7,13,0,,"0000000000000001111100101010011111000000000000000",14,11],[7,13,0,,"0000000000000000001100001110001111001111000000000",26,11]],O=[]);for(var ga in objects.innerHTML="",puzzle.innerHTML="",K)objects.innerHTML+=`<div id=tree${ga} class="emoji tree" style="left:${K[ga][0]*q}vh;top:${K[ga][1]*q}vh;transform:translateZ(${K[ga][2]*q+2}vh)translateX(-8vh)translateY(-11vh)rotateX(-75deg)">??</div><div id=treeshadow${ga} class="emojishadow treeshadow" style="left:${K[ga][0]*q}vh;top:${K[ga][1]*q}vh;transform:translateZ(${K[ga][2]*q}vh)translateX(-8vh)translateY(-15vh)rotateZ(144deg)scaleY(1.5)">??`;for(ga in M)n[o+"appleeaten"+ba+ga]?delete M[ga]:objects.innerHTML+=`<div id=apple${ga} class="emoji apple ${n[o+"appleappeared"+ba+ga]?"":"hidden"}" style="left:${M[ga][0]*q}vh;top:${M[ga][1]*q}vh">??</div><div id=appleshadow${ga} class="emojishadow appleshadow ${n[o+"appleappeared"+ba+ga]?"":"hidden"}" style="left:${M[ga][0]*q}vh;top:${M[ga][1]*q}vh">??`;for(ga in N)objects.innerHTML+=`<div id=door${ga} class="door${n[o+"door"+ba+ga]?" open":""}" style="left:${(N[ga][0]+.5)*q}vh;top:${(N[ga][1]+.5)*q}vh;transform:rotateZ(${N[ga][2]}rad)translateZ(${N[ga][9]*q}vh)"><div class=realdoor ${N[ga][6]?"":"hidden"}>${N[ga][3]}</div><div class=path>`;for(ga in O)objects.innerHTML+=`<div id=cube${ga} class="cube rock" style="left:${O[ga][0]*q}vh;top:${O[ga][1]*q}vh;width:7vh;height:7vh"><div class=front></div><div class=up style="background-position:${-300-O[ga][0]*q}vh ${-140-O[ga][1]*q}vh"></div><div class=right></div><div class=left></div><div class=back></div><div class=down>`;for(var ha in Q){var ja="",ka=`<div class="cube wrap visible" style="left:${Q[ha][5]*q}vh;top:${Q[ha][6]*q}vh;width:${Q[ha][0]*q}vh;height:${Q[ha][0]*q}vh">
<!--div class=left></div>
<div class=right></div-->
<div id=down${ha} class=down></div>
<!--div id=back${ha} class=back></div-->
<!--div class=up></div>
<div class=front-->`;puzzle.innerHTML+=ka;var la="000",ma="fff";for(n[o+"puzzle"+ba+ha]&&(la="080",ma="fd0"),ga=0;ga<Q[ha][0];ga++)for(j=0;j<Q[ha][0];j++)ja+=`<div class=cell id=g${ha}-${ga}-${j} style='width:${q}vh;height:${q}vh;background:#${"1"==Q[ha][4][ga*Q[ha][0]+j]?la:ma}'></div>`;top["down"+ha].innerHTML+=ja}"hub"!=ba||n[o+"snakex"]?(scene.style.transition="transform .8s, transform-origin .8s linear",da()):debug?(scene.style.transition="transform .8s linear, transform-origin .8s linear",da(),movesnake(),w.push(w[v]),A.push(A[v]),C.push(0),D.push(D[v]),v++,movesnake()):(J=1,setTimeout("resetsnake();movesnake();snakecubemove0.style.transition=\"transform .5s\"",2e3),setTimeout("snakex.push(snakex[head]);snakey.push(snakey[head]);snakez.push(0);snakeangle.push(snakeangle[head]);head++;movesnake()",4500),setTimeout("snakecubemove0.style.transition='';snakeshadow0.style.transition=snakecuberotate0.style.transition='transform .2s';snakeshadow0.style.transform=snakecuberotate0.style.transform='rotateZ("+-Math.PI/4+"rad)'",5e3),setTimeout("snakeshadow0.style.transform=snakecuberotate0.style.transform='rotateZ("+Math.PI/4+"rad)'",5500),setTimeout("snakeshadow0.style.transform=snakecuberotate0.style.transform='';",6e3),setTimeout("scene.style.transition='transform .8s, transform-origin .8s linear';snakeshadow0.style.transition=snakecuberotate0.style.transition='';lock=0",9e3)),movesnake()},da=ga=>{if(snake.innerHTML="",ga||(w=[],A=[],C=[],D=[]),F,v=E-1,!ga){if(n[o+"snakex"]){var ha=+n[o+"snakex"],ia=+n[o+"snakey"],ja=+n[o+"snakez"];if(2>ha)for(i=0;i<E;i++)w[v-i]=ha-i,A[v-i]=ia,C[v-i]=ja,D[v-i]=-Math.PI/2;else if(28<ha)for(i=0;i<E;i++)w[v-i]=ha+i,A[v-i]=ia,C[v-i]=ja,D[v-i]=Math.PI/2;else if(2>ia)for(i=0;i<E;i++)w[v-i]=ha,A[v-i]=ia-i,C[v-i]=ja,D[v-i]=0;else if(18<ia)for(i=0;i<E;i++)w[v-i]=ha,A[v-i]=ia+i,C[v-i]=ja,D[v-i]=0;else for(i=0;i<E;i++)w[v-i]=10,A[v-i]=10,C[v-i]=-i,D[v-i]=Math.PI}else if("hub"==b.className)for(i=0;i<E;i++)w[v-i]=20,A[v-i]=10,C[v-i]=-i-1,D[v-i]=0}for(i=0;i<Math.max(E,16);i++)snake.innerHTML+=`<div id=snakecubemove${i} class=snakecubemove style="transform:translateX(50vh)translateY(50vh)translateZ(-10vh);width:${q-1}vh;height:${q-1}vh"><div class=snakeshadow id=snakeshadow${i}></div><div id=snakecuberotate${i} class=snakecuberotate><div class="cube snake" id=snakecube${i}>${1>i?"<div class=tongue>Y</div>":""}<div class=front>${1>i?"\u203F":""}</div><div class=up style="font-size:${.5*q}vh;line-height:${.8*q}vh">${1>i?"\uD83D\uDC40":""}</div><div class=right></div><div class=left></div><div class=back>`};movesnake=()=>{for(ka=0;ka<E;ka++){var ga=oldx=oldy=oldz=newx=newy=newz=0;X&&(0==w[v-ka-1]&&w[v-ka]==size-1&&(ga=1,oldx=-1,newx=size,oldy=newy=A[v-ka],oldz=newz=C[v-ka]),w[v-ka-1]==size-1&&0==w[v-ka]&&(ga=1,oldx=size,newx=-1,oldy=newy=A[v-ka],oldz=newz=C[v-ka]),0==A[v-ka-1]&&A[v-ka]==size-1&&(ga=1,oldy=-1,newy=size,oldx=newx=w[v-ka],oldz=newz=C[v-ka]),A[v-ka-1]==size-1&&0==A[v-ka]&&(ga=1,oldy=size,newy=-1,oldx=newx=w[v-ka],oldz=newz=C[v-ka]),0==C[v-ka-1]&&C[v-ka]==size-1&&(ga=1,oldz=-1,newz=size,oldx=newx=w[v-ka],oldy=newy=A[v-ka]),C[v-ka-1]==size-1&&0==C[v-ka]&&(ga=1,oldz=size,newz=-1,oldx=newx=w[v-ka],oldy=newy=A[v-ka])),ga?(top["snakecuberotate"+ka].style.transform=`rotateZ(${D[v-ka]}rad)`,top["snakecubemove"+ka].style.transform=`translateX(${oldx*q+.5}vh)translateY(${oldy*q+.5}vh)translateZ(${oldz*q+.5}vh)scale(.01)scaleZ(.01)`,setTimeout("snakecubemove"+ka+".style.transition='none'",150),setTimeout("snakecubemove"+ka+".style.transform=`translateX(${"+newx+"*sidesize+.5}vh)translateY(${"+newy+"*sidesize+.5}vh)translateZ(${"+newz+"*sidesize+.5}vh)scale(.01)`",175),setTimeout("snakecubemove"+ka+".style.transition='';snakecubemove"+ka+".style.transform=`translateX(${snakex["+(v-ka)+"]*sidesize+.5}vh)translateY(${snakey["+(v-ka)+"]*sidesize+.5}vh)translateZ(${snakez["+(v-ka)+"]*sidesize+.5}vh)`",200)):(top["snakecubemove"+ka].style.transform=`translateX(${w[v-ka]*q+.5}vh)translateY(${A[v-ka]*q+.5}vh)translateZ(${C[v-ka]*q+.9}vh)`,top["snakecuberotate"+ka].style.transform=`rotateZ(${D[v-ka]}rad)`),top["snakeshadow"+ka].style.display=0==C[v-ka]?"":"none",null===R||n[o+"puzzle"+ba+R]?(scene.style.transform="translateX("+-w[v]*q+"vh)translateY("+-A[v]*q+"vh)translateZ(-5vh)rotateX(45deg)",scene.style.transformOrigin=""+w[v]*q+"vh "+A[v]*q+"vh"):(scene.style.transform="translateX("+(-(Q[R][5]+Q[R][1]/2)*q+15)+"vh)translateY("+(-(Q[R][6]+Q[R][1]/2)*q+13)+"vh)translateZ("+(80-Q[R][0]*(q+2))+"vh)rotateX(25deg)",scene.style.transformOrigin=""+(Q[R][5]+Q[R][1]/2)*q+"vh "+((Q[R][6]+Q[R][1]/2)*q+13)+"vh")}var ha=w[v],ia=A[v],ja=C[v];for(var ka in N)0<N[ka][3]&&E>=N[ka][3]&&4>Math.hypot(ha-N[ka][0],ia-N[ka][1])&&(top["door"+ka].className="door open",n[o+"door"+ba+ka]=1),"door open"==top["door"+ka].className&&2>Math.hypot(ha-N[ka][0],ia-N[ka][1])&&(n[o+"page"]=ba=N[ka][5],setTimeout(ca,1e3),n[o+"snakex"]=N[ka][7],n[o+"snakey"]=N[ka][8],n[o+"snakez"]=0,n[o+"snakeangle"]=D[v]);for(p in checkgrid(),R=null,T=[],Q)if(ha>=Q[p][5]&&ha<Q[p][5]+Q[p][0]&&ia>=Q[p][6]&&ia<Q[p][6]+Q[p][0]){for(R=+p,Y=0,n[o+"puzzle"+ba+p]&&(Y=1),S=p,V=!!Q[p][4],W=!!Q[p][3],Z=Q[p][5],$=Q[p][6],size=Q[p][0],ka=0;ka<size;ka++)for(T[ka]=[],j=0;j<size;j++)T[ka][j]=+Q[p][4][ka*Q[p][0]+j];checkgrid()}},checkmove=(ga,ha,ia)=>{for(var ja in aa=0,(0>ga||40<=ga||0>ha||20<=ha)&&(aa=1),K)ga>=K[ja][0]-1&&ga<=K[ja][0]+1&&ha==K[ja][1]&&(aa=1);for(var ja in M)n[o+"appleappeared"+ba+ja]&&ga==M[ja][0]&&ha==M[ja][1]&&(delete M[ja],top["apple"+ja].remove(),top["appleshadow"+ja].remove(),E++,n[o+"snakelength"]=E,n[o+"appleeaten"+ba+ja]=1);for(var ja in O)ga==O[ja][0]&&ha==O[ja][1]&&(aa=1);for(var ja in N)"door open"==top["door"+ja].className&&2>=Math.hypot(ga-N[ja][0],ha-N[ja][1])&&(aa=0);for(ja=E-2;0<ja;ja--)w[v-ja]==ga&&A[v-ja]==ha&&C[v-ja]==ia&&(aa=1)},checkgrid=()=>{if(!Y&&null!==R){for(solved=1,i=0;i<size;i++)for(j=0;j<size;j++)top[`g${S}-${i}-${j}`]&&(top[`g${S}-${i}-${j}`].style.background=T[i][j]?"#000":"#fff"),top[`w${S}-{i}-${j}`]&&(top[`w${S}-{i}-${j}`].style.background=U[i][j]?"#000":"#fff");if(!(w[v]<Z||w[v]>Z+size-1||A[v]<$||A[v]>$+size-1||0>C[v]||C[v]>size-1)){for(i=0;i<E;i++)top[`g${S}-${A[v-i]-$}-${w[v-i]-Z}`]&&(top[`g${S}-${A[v-i]-$}-${w[v-i]-Z}`].style.background=T[A[v-i]-$][w[v-i]-Z]?"#080":"#F00"),(w[v-i]<Z||w[v-i]>Z+size-1||A[v-i]<$||A[v-i]>$+size-1||0>C[v-i]||C[v-i]>size-1)&&(solved=0),V&&T[A[v-i]-$]&&!T[A[v-i]-$][w[v-i]-Z]&&(solved=0),W&&U[size-1-C[v-i]]&&!U[size-1-C[v-i]][w[v-i]-Z]&&(solved=0);for(i=0;i<size;i++)for(j=0;j<size;j++)V&&"#000"==top[`g${S}-${i}-${j}`].style.backgroundColor&&(solved=0),W&&"#000"==top[`w${S}-${i}-${j}`].style.backgroundColor&&(solved=0);if(solved){for(Y=1,n[o+"puzzle"+ba+R]=1,i=0;i<size;i++)for(j=0;j<size;j++)top[`g${S}-${i}-${j}`]&&(top[`g${S}-${i}-${j}`].style.background=T[i][j]?"green":"gold"),top[`w${S}-{i}-${j}`]&&(top[`w${S}-{i}-${j}`].style.background=U[i][j]?"green":"gold");_++,n[o+"totalsolved"]=_}}}},checkapple=()=>{for(var ha in M)!n[o+"appleappeared"+ba+ha]&&(0<M[ha][3]&&M[ha][3]==E||0<M[ha][4]&&M[ha][4]==_)&&(J=1,setTimeout(`scene.style.transform="translateX("+(-apples[`+ha+`][0]*sidesize)+"vh)translateY("+(-apples[`+ha+`][1]*sidesize)+"vh)translateZ(-5vh)rotateX(30deg)";

L[P + "appleappeared"+pagename+"`+ha+`"] = 1;

scene.style.transformOrigin=""+(apples[`+ha+`][0]*sidesize)+"vh "+(apples[`+ha+`][1]*sidesize)+"vh";

// Show apple falling
top["apple"+`+ha+`].className = "emoji apple";
top["appleshadow"+`+ha+`].className = "emojishadow appleshadow";`,250),setTimeout("movesnake();lock=0",2e3))},onkeydown=ga=>{top["lurd************************l**r************l*d***u**u"[ga.which-37]]=1,(8==ga.which||18==ga.which)&&(B=1),16==ga.which&&(s=1),17==ga.which&&(c=1),116!=ga.keyCode&&82!=ga.keyCode&&17!=ga.keyCode&&123!=ga.keyCode&&ga.preventDefault();var ha=0;G&&H&&0<=w[v]&&w[v]<size&&0<=A[v]&&A[v]<size&&0<=C[v]&&C[v]<size&&(ha=1),G&&!J&&(aa=0,l?X&&ha&&0==w[v]?(checkmove(size-1,A[v],C[v]),!aa&&(w.push(size-1),A.push(A[v]),C.push(C[v]),D.push(Math.PI/2),v++)):(checkmove(w[v]-1,A[v],C[v]),!aa&&(w.push(w[v]-1),A.push(A[v]),C.push(C[v]),D.push(Math.PI/2),v++)):r?X&&ha&&w[v]==size-1?(checkmove(0,A[v],C[v]),!aa&&(w.push(0),A.push(A[v]),C.push(C[v]),D.push(-Math.PI/2),v++)):(checkmove(w[v]+1,A[v],C[v]),!aa&&(w.push(w[v]+1),A.push(A[v]),C.push(C[v]),D.push(-Math.PI/2),v++)):I?X&&ha&&0==A[v]?(checkmove(w[v],size-1,C[v]),!aa&&(w.push(w[v]),A.push(size-1),C.push(C[v]),D.push(Math.PI),v++)):(checkmove(w[v],A[v]-1,C[v]),!aa&&(w.push(w[v]),A.push(A[v]-1),C.push(C[v]),D.push(Math.PI),v++)):d?X&&ha&&A[v]==size-1?(checkmove(w[v],0,C[v]),!aa&&(w.push(w[v]),A.push(0),C.push(C[v]),D.push(0),v++)):(checkmove(w[v],A[v]+1,C[v]),!aa&&(w.push(w[v]),A.push(A[v]+1),C.push(C[v]),D.push(0),v++)):W&&s?X&&ha&&C[v]==size-1?(checkmove(w[v],A[v],0),!aa&&(w.push(w[v]),A.push(A[v]),C.push(0),D.push(D[v]),v++)):(checkmove(w[v],A[v],C[v]+1),!aa&&(w.push(w[v]),A.push(A[v]),C.push(C[v]+1),D.push(D[v]),v++)):W&&c?X&&ha&&0==C[v]?(checkmove(w[v],A[v],size-1),!aa&&(w.push(w[v]),A.push(A[v]),C.push(size-1),D.push(D[v]),v++)):0==C[v]?aa=1:(checkmove(w[v],A[v],C[v]-1),!aa&&(w.push(w[v]),A.push(A[v]),C.push(C[v]-1),D.push(D[v]),v++)):B&&v>E&&(D.pop(),w.pop(),A.pop(),C.pop(),v--),!aa&&(I||r||d||l||s||c||B)&&(movesnake(),F,movesnake(),checkapple(),!J&&(J=1,setTimeout("lock=0",100))))},onkeyup=()=>{I=r=d=l=s=c=B=0}};